## k-nim

一共有 $n$ 堆石子，每次可以取 $1\sim k$ 堆石子数量不限，不能取的失败。

设第 $i$ 堆的个数为 $a_i$，记 $r_j$ 为所有 $a_i$ 二进制下第 $j$ 位的 $1$ 的个数对 $k+1$ 取模的值，那么全部是 $0$ 的就是必败态，否则是必胜态。

考虑归纳证明。对于一个全部是 $0$ 的要么不能操作要么操作至少有一个不是 $0$。

然后我们再证明不全是 $0$ 的可以通过一步操作变成全是 $0$。可以从高到低位构造，首先我们让最高位的值挑选 $r_{\text{最高位}}$ 个变成 $0$，记 $x=r_{\text{最高位}}$，那么这 $x$ 个后面的值可以随便取。然后往低位走，把这 $x$ 个全部这一位设为 $1$ 得到 $r'$，然后如果 $r'\le x$ 就直接在前面 $x$ 个数中选 $r'$ 个这一位是 $0$。否则就挑选到足够 $r'$ 个，把 $x$ 设为 $r'$。因为 $r'\le k$ 所以 $x\le k$，构造合法。

